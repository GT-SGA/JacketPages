<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title></title>
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="stylesheet" href="../src/jquery.typeahead.css">

    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="../src/jquery.typeahead.js"></script>

</head>

<body>

    <div style="width: 100%; max-width: 800px; margin: 0 auto;">

        <h1>Game_v1 Demo</h1>

        <ul>
            <li>
                <a href="http://www.runningcoder.org/jquerytypeahead/documentation/">Documentation</a>
            </li>
            <li>
                <a href="http://www.runningcoder.org/jquerytypeahead/demo/">Demos</a>
            </li>
        </ul>

        <div style="margin-bottom: 20px;">
            <button onclick="addRandomTeam()">Add a random Team</button>
            <button onclick="removeRandomTeam()">Remove a random Team</button>
        </div>

        <form>
            <div class="typeahead__container">
                <div class="typeahead__field">
                    <div class="typeahead__query">
                        <input class="js-typeahead" name="q" type="search" autofocus autocomplete="off">
                    </div>
                    <div class="typeahead__button">
                        <button type="submit">
                            <span class="typeahead__search-icon"></span>
                        </button>
                    </div>
                </div>
            </div>
        </form>

        <script>

            $.typeahead({
                input: '.js-typeahead',
                minLength: 1,
                maxItem: 0,
                order: "asc",
                hint: true,
                group: true,
                maxItemPerGroup: 5,
                dropdownFilter: "all",
                dynamic: true,
                source: {
                    game: {
                        data: [{
                            id: 777,
                            display: "Sky Shooter"
                        }, {
                            id: 1001,
                            display: "Elite shooter 6"
                        }],
                        ajax: {
                            url: "http://www.gamer-hub.com/game/list.json",
                            dataType: "jsonp",
                            path: "data"
                        }
                    },
                    category: {
                        ajax: {
                            url: "http://www.gamer-hub.com/category/list.json",
                            dataType: "jsonp",
                            path: "data"
                        }
                    },
                    tag: {
                        ajax: {
                            url: "http://www.gamer-hub.com/tag/list.json",
                            dataType: "jsonp",
                            path: "data"
                        }
                    }
                },
                callback: {
                    onNavigateBefore: function (node, query, event) {
                        if (~[38, 40].indexOf(event.keyCode)) {
                            event.preventInputChange = true;
                        }
                    },
                    onClick: function (node, a, item, event) {
                        window.open(
                            "http://www.gamer-hub.com/" +
                            item.group + "/" +
                            item.id + "/" +
                            item.display.replace(/[\s]|:\s/g, "-")
                                .replace("'", "-")
                                .toLowerCase()
                            + "/"
                        );
                    },
                    onMouseEnter: function (node, a, item, event) {
                        if (item.group !== "game") {
                            return false;
                        }

                        if (!$(a).find(".popover")[0]) {

                            $(a).append(
                                $("<div/>", {
                                    "class": "popover fade right in",
                                    "html": $("<div/>", {
                                        "class": "popover-content",
                                        "html": $("<img/>", {
                                            "src": "http://cdn.gamer-hub.com/images/" +
                                                item.display.replace(/[\s]|:\s/g, "-")
                                                    .replace("'", "-")
                                                    .replace(/-+/g, "-")
                                                    .toLowerCase()
                                                + ".jpg"
                                        })
                                    }).prepend($("<div/>", {
                                        "class": "arrow"
                                    }))
                                })
                            );

                        } else {
                            $(a).find(".popover").removeClass("out").addClass("in");
                        }
                    },
                    onMouseLeave: function (node, a, item, event) {
                        if (item.group !== "game") {
                            return false;
                        }

                        $(a).find(".popover").removeClass("in").addClass("out");
                    }
                }
            });

        </script>
    </div>

</body>

</html>